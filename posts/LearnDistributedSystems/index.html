<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Distributed Systems Notes" /><meta property="og:locale" content="en" /><meta name="description" content="1. RPC and Multi-Threads reason for multi-threads: I/O concurrency Parallelism(multiple cores, true parallelism, multiple cpu cycles per second) Convenience(fire something every some seconds in loop waiting for separate work; notice to exit every routine gracefully! otherwise accumulating in background!)" /><meta property="og:description" content="1. RPC and Multi-Threads reason for multi-threads: I/O concurrency Parallelism(multiple cores, true parallelism, multiple cpu cycles per second) Convenience(fire something every some seconds in loop waiting for separate work; notice to exit every routine gracefully! otherwise accumulating in background!)" /><link rel="canonical" href="https://anikiz.github.io/posts/LearnDistributedSystems/" /><meta property="og:url" content="https://anikiz.github.io/posts/LearnDistributedSystems/" /><meta property="og:site_name" content="AnikiZ" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-10-09T22:28:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Distributed Systems Notes" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-19T05:52:17+00:00","datePublished":"2022-10-09T22:28:00+00:00","description":"1. RPC and Multi-Threads reason for multi-threads: I/O concurrency Parallelism(multiple cores, true parallelism, multiple cpu cycles per second) Convenience(fire something every some seconds in loop waiting for separate work; notice to exit every routine gracefully! otherwise accumulating in background!)","headline":"Distributed Systems Notes","mainEntityOfPage":{"@type":"WebPage","@id":"https://anikiz.github.io/posts/LearnDistributedSystems/"},"url":"https://anikiz.github.io/posts/LearnDistributedSystems/"}</script><title>Distributed Systems Notes | AnikiZ</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="AnikiZ"><meta name="application-name" content="AnikiZ"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">AnikiZ</a></div><div class="site-subtitle font-italic">My heart is in the work</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/AnikiZ" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/zeping-zhu-6a1534248/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['zepingz','andrew.cmu.edu'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Distributed Systems Notes</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Distributed Systems Notes</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1665354480" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 9, 2022 </em> </span> <span> Updated <em class="" data-ts="1666158737" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 19, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/AnikiZ">Zeping Zhu</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="886 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><h1 id="1-rpc-and-multi-threads">1. RPC and Multi-Threads</h1><p>reason for multi-threads:</p><ol><li>I/O concurrency<li>Parallelism(multiple cores, true parallelism, multiple cpu cycles per second)<li>Convenience(fire something every some seconds in loop waiting for separate work; notice to exit every routine gracefully! otherwise accumulating in background!)</ol><p>what if not use multi-threads while still enabling multiple servers to communicate with various clients?</p><font color="Blue">Async programming/Event-Driven programming</font><p>single thread, single loop waiting for any input/event/timer fire interesting: use multiple cores, each responsible for an event-driven loop, can also act like multi-threads</p><p>process vs thread Process: a single programming you are running. In a go program, it will create one UNIX process and one memory area. When you create many go routines, these threads will run sitting in this process within same memory space.</p><p>Example: URL crawler</p><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre><td class="rouge-code"><pre><span class="c">// should have a record of the URLs, otherwise keep crawling because pages in URL is cyclic</span>
<span class="c">// Serial Crawler</span>
<span class="k">func</span> <span class="n">Serial</span><span class="p">(</span><span class="n">url</span> <span class="kt">string</span><span class="p">,</span> <span class="n">fetcher</span> <span class="n">Fetcher</span><span class="p">,</span> <span class="n">fetched</span> <span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
    <span class="c">// use a pointer of the map, not copy to prevent duplicated search</span>
    <span class="k">if</span> <span class="n">fetched</span><span class="p">[</span><span class="n">url</span><span class="p">]</span> <span class="p">{</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="n">fetched</span><span class="p">[</span><span class="n">url</span><span class="p">]</span> <span class="o">=</span> <span class="no">true</span>
    <span class="n">urls</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">fetcher</span><span class="o">.</span><span class="n">Fetch</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">u</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">urls</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">fetcher</span><span class="p">,</span> <span class="n">fetched</span><span class="p">)</span>
        <span class="c">// what if change to go Serial(u, fetcher, fetched)?</span>
        <span class="c">// only print one page because the main function will return, not waiting</span>
    <span class="p">}</span>
    <span class="k">return</span>
<span class="p">}</span>

<span class="c">// concurrent crawler with shared state and Mutex</span>
<span class="k">type</span> <span class="n">fetchState</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">mu</span> <span class="n">sync</span><span class="o">.</span><span class="n">Mutex</span>
    <span class="n">fetched</span> <span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">bool</span>
<span class="p">}</span>
<span class="k">func</span> <span class="n">ConcurrentMutex</span><span class="p">(</span><span class="n">url</span> <span class="kt">string</span><span class="p">,</span> <span class="n">fetcher</span> <span class="n">Fetcher</span><span class="p">,</span> <span class="n">f</span> <span class="o">*</span><span class="n">fetchState</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">f</span><span class="o">.</span><span class="n">mu</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
    <span class="n">already</span> <span class="o">:=</span> <span class="n">f</span><span class="o">.</span><span class="n">fetched</span><span class="p">[</span><span class="n">url</span><span class="p">]</span>
    <span class="n">f</span><span class="o">.</span><span class="n">fetched</span><span class="p">[</span><span class="n">url</span><span class="p">]</span> <span class="o">=</span> <span class="no">true</span>
    <span class="n">f</span><span class="o">.</span><span class="n">mu</span><span class="o">.</span><span class="n">Unlock</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">already</span> <span class="p">{</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="n">urls</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">fetcher</span><span class="o">.</span><span class="n">Fetch</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="k">var</span> <span class="n">done</span> <span class="n">sync</span><span class="o">.</span><span class="n">WaitGroup</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">u</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">urls</span> <span class="p">{</span>
        <span class="c">// done.Add(1)</span>
        <span class="n">done</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
        <span class="k">go</span> <span class="k">func</span><span class="p">(</span><span class="n">url</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">ConcurrentMutex</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">fetcher</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">defer</span> <span class="n">done</span><span class="o">.</span><span class="n">Done</span><span class="p">()</span> <span class="c">// decrement the done counter</span>
            <span class="c">// use defer to call done no matter whether ConcurrentMutex will be executed successfully</span>
        <span class="p">}(</span><span class="n">u</span><span class="p">)</span>
        <span class="c">// here, the string parameter is a value copy of the outer u, not pointer</span>
        <span class="c">// because string is immutable. Otherwise, the u will change in the outer for loop, and will change the u in the inner function!</span>
    <span class="p">}</span>
    <span class="n">done</span><span class="o">.</span><span class="n">Wait</span><span class="p">()</span> <span class="c">// wait the counter to down to zero</span>
    <span class="k">return</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="q-if-the-surrounding-function-returns-what-will-happen-to-the-inner-functions-reference-to-variables-in-surrounding-function"><span class="mr-2">Q: If the surrounding function returns, what will happen to the inner function’s reference to variables in surrounding function?</span><a href="#q-if-the-surrounding-function-returns-what-will-happen-to-the-inner-functions-reference-to-variables-in-surrounding-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In go, the compiler will analyze the inner function(also called closured function) and allocate a heap memory for the variable. So the inner function can still get it and the gabbage collecter is responsible for noticing the last function to refer the little piece of heap and when it returns and releases then.</p><h3 id="q-race-detector-in-go"><span class="mr-2">Q: race detector in go</span><a href="#q-race-detector-in-go" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>It allocates sort of shadow memory, (huge memory) almost for every memory location and keeps track of which thread read/write the memory location. And keep tracking of requiring/releasing locks and doing other synchronization activities/forcing other threads to not run concurrently. If it detects one of the location is written while another thread is reading the memory without a lock notation, it will release error. (Not static analyzing, but watching what happens in a particular part of the program. If this part didn’t execute some code, like reading or writing a shared data, the race detector will never know whether there could be a race. So we need to set up some sort of a testing apparatus to make sure all the codes can be executed.) Actually the detector didn’t see the interleaving/simultaneous execution, it just use the shadow memory to detect possible simultaneous read/write race without lock.</p><h3 id="q-how-many-threads"><span class="mr-2">Q: How many threads?</span><a href="#q-how-many-threads" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In practical, there will be billions of urls, and to create billions of threads(too many memory, not feasible). Solution: pre-create a fixed size of pools of workers and have workers iteratively crawl.</p><h3 id="use-channel-for-concurrent-crawling"><span class="mr-2">Use channel for concurrent crawling</span><a href="#use-channel-for-concurrent-crawling" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="c">// no need to worry about shared memory by using channel</span>
<span class="k">func</span> <span class="n">worker</span><span class="p">(</span><span class="n">url</span> <span class="kt">string</span><span class="p">,</span> <span class="n">ch</span> <span class="k">chan</span> <span class="p">[]</span><span class="kt">string</span><span class="p">,</span> <span class="n">fetcher</span> <span class="n">Fetcher</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">urls</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">fetcher</span><span class="o">.</span><span class="n">Fetch</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">ch</span> <span class="o">&lt;-</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">ch</span> <span class="o">&lt;-</span> <span class="n">urls</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">master</span><span class="p">(</span><span class="n">ch</span> <span class="k">chan</span> <span class="p">[]</span><span class="kt">string</span><span class="p">,</span> <span class="n">fetcher</span> <span class="n">Fetcher</span><span class="p">)</span> <span class="p">{</span>
    <span class="c">// the master that use the channel</span>
    <span class="n">n</span> <span class="o">:=</span> <span class="m">1</span>
    <span class="n">fetched</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">bool</span><span class="p">)</span>
    <span class="c">// range: keep waiting until receive a new channel</span>
    <span class="c">// if the channel is not closed, range will keep blocking</span>
    <span class="c">// only condition to return is when n==0</span>
    <span class="k">for</span> <span class="n">urls</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">ch</span> <span class="p">{</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">u</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">urls</span> <span class="p">{</span>
            <span class="k">if</span> <span class="n">fetched</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="no">false</span> <span class="p">{</span>
                <span class="n">fetched</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="no">true</span>
                <span class="c">// n add 1 for each worker</span>
                <span class="n">n</span><span class="o">+=</span><span class="m">1</span>
                <span class="k">go</span> <span class="n">worker</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">ch</span><span class="p">,</span> <span class="n">fetcher</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">n</span> <span class="o">-=</span> <span class="m">1</span>
        <span class="c">// n=0, meaning no one is using the channel anymore</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="m">0</span> <span class="p">{</span>
            <span class="k">break</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">func</span> <span class="n">ConcurrentChannel</span><span class="p">(</span><span class="n">url</span> <span class="kt">string</span><span class="p">,</span> <span class="n">fetcher</span> <span class="n">Fetcher</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ch</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="p">[]</span><span class="kt">string</span><span class="p">)</span>
    <span class="k">go</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">ch</span> <span class="o">&lt;-</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="n">url</span><span class="p">}</span>
    <span class="p">}()</span>
    <span class="n">master</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">fetcher</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/courses/'>Courses</a>, <a href='/categories/distributed-system/'>Distributed System</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/go-instant-messaging-system-programming/" class="post-tag no-text-decoration" >Go Instant messaging System Programming</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Distributed+Systems+Notes+-+AnikiZ&url=https%3A%2F%2Fanikiz.github.io%2Fposts%2FLearnDistributedSystems%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Distributed+Systems+Notes+-+AnikiZ&u=https%3A%2F%2Fanikiz.github.io%2Fposts%2FLearnDistributedSystems%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fanikiz.github.io%2Fposts%2FLearnDistributedSystems%2F&text=Distributed+Systems+Notes+-+AnikiZ" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Leetcode1/">Leetcode笔记（一)</a><li><a href="/posts/LearnDistributedSystems/">Distributed Systems Notes</a><li><a href="/posts/typora/">Markdown+Typora学习笔记</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/go-instant-messaging-system-programming/">Go Instant messaging System Programming</a> <a class="post-tag" href="/tags/blockchains/">Blockchains</a> <a class="post-tag" href="/tags/java-web-programming/">Java Web Programming</a> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/manual/">manual</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/GoMessagingSystem/"><div class="card-body"> <em class="small" data-ts="1663011540" data-df="ll" > Sep 12, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Distributed System__Instant messaging system mode</h3><div class="text-muted small"><p> Demo1: Instant messaging system - Server reference 1. Construct basic Server server.go, contains following; Server Struct, containing Ip, Port NewServer(ip String, port int) method to create s...</p></div></div></a></div><div class="card"> <a href="/posts/JavaWeb/"><div class="card-body"> <em class="small" data-ts="1662867540" data-df="ll" > Sep 11, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Distributed System__Java Web Programming Practice</h3><div class="text-muted small"><p> Port(PID) netstat -ano #查看所有端口 netstat -ano|findstr &quot;6732&quot; #查看指定端口 tasklist|findstr &quot;6732&quot; #查看指定进程 # 使用任务管理器查看PID 端口号与IP地址的组合，得出一个网络套接字:Socket，所以说一些网络编程也被称为Socket编程 import java.net.InetSocketAddr...</p></div></div></a></div><div class="card"> <a href="/posts/SmallGame/"><div class="card-body"> <em class="small" data-ts="1661913000" data-df="ll" > Aug 31, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Foundations of Blockchains_18635 Note</h3><div class="text-muted small"><p> An interesting card love dating game: Target: Alice and Bob, if both love each other, dating; otherwise, not dating Prerequisite: honest-but-curious, can’t be ‘malicious’ Method 1: ❤️: love ♣️: ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/GoMessagingSystem/" class="btn btn-outline-primary" prompt="Older"><p>Distributed System__Instant messaging system mode</p></a><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/AnikiZ">Zeping Zhu</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/go-instant-messaging-system-programming/">Go Instant messaging System Programming</a> <a class="post-tag" href="/tags/blockchains/">Blockchains</a> <a class="post-tag" href="/tags/java-web-programming/">Java Web Programming</a> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/manual/">manual</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
